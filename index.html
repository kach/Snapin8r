<!DOCTYPE html>
<html>
	<head>
		<title>Snapin8r</title>
		<script src="snapin8r.min.js"></script>
		<script>
			window.addEventListener("load", function() {
				var dropzone = document.getElementById("dropzone");
				function handleDrop(e) {
					e.stopPropagation(); // Stops some browsers from redirecting.
					e.preventDefault();

					var file = e.dataTransfer.files[0];
					var reader = new FileReader();
					reader.onload = function(e) {
						try {
							var zip = new JSZip(e.target.result);
							var l = document.createElement("a");
							l.href = "http://snap.berkeley.edu/snapsource/snap.html#open:"
								+ encodeURIComponent(Snapin8r(zip, file.name.replace(".sb2", "")));
							l.innerHTML = "Believe it or not, it worked. Click here to open your project!";
							l.style.color = "green";
							dropzone.style.backgroundColor = "#aea";
							while (dropzone.firstChild) {
								dropzone.removeChild(dropzone.firstChild);
							}
							dropzone.appendChild(l);
						} catch (err) {
							var l = document.createElement("span");
							l.innerHTML = "Well, this is embarassing.<br/>The ancient geekish runes read: <code>"+err+"</code> Chances are, you use a special Scratch feature that we don't know how to convert. Sorry! You can help us out by reporting this error.";
							l.style.color = "#300";
							dropzone.style.backgroundColor = "#eaa";
							while (dropzone.firstChild) {
								dropzone.removeChild(dropzone.firstChild);
							}
							dropzone.appendChild(l);
						}
					}
					reader.readAsArrayBuffer(file);
				}

				dropzone.addEventListener("drop", handleDrop, false);
			}, false);
		</script>
		<style>
			html {
				padding:0px;
				height: 100%;
			}
			body {
				padding: 0px;
				margin: 0px;
				height: 100%;
				font-family: sans-serif;
			}
			#wrapper {
				width:100%;
				height: 100%;
			}
			#left-column {
				width:30%;
				padding: 10px;
				overflow-y:scroll;
				float:left;
			}
			#right-column {
				padding:0px;
				float: left;
				width:60%;
				height: 90%;
				padding:10px;
				display: table;
			}

			#dropzone {
				border-style: dashed;
				border-radius: 30px;
				border-color: #eee;
				height: 100%;
				text-align: center;
				display: table-cell;
				vertical-align: middle;
				color:#aaa;
				padding: 10px;
			}
			p {
				text-indent: 10px;
			}
			h1 {
				text-align: center;
			}
		</style>
	</head>
	<body>
		<div id="wrapper">
			<div id="left-column">
				<h1>Snapin8r</h1>
				<p>Snapin8r converts a subset <a href="http://scratch.mit.edu">Scratch 2.0</a> projects to <a href="http://snap.berkeley.edu">Snap!</a> projects. This page lets you use the current development version of Snapin8r to convert your projects.

				<p>Snapin8r can't convert projects that use Scratch specific features, specifically cloud variables, the username reporter, and certain unsupported blocks. Furthermore, being on the bleeding edge means that you might get errors in conversion because of unresolved bugs&mdash;please report these to <a href="http://scratch.mit.edu/users/Hardmath123">@Hardmath123</a> on Scratch or <a href="https://github.com/Hardmath123/Snapin8r/issues">on Github</a>
			</div>
			<div id="right-column">
				<div id="dropzone">
					Drop an <code>sb2</code> file here&hellip;
				</div>
			</div>
		</div>
	</body>
</html>